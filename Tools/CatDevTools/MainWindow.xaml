<Window x:Class="CatDevTools.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:CatDevTools.ViewModels"
        xmlns:views="clr-namespace:CatDevTools.Views"
        Title="CatTalk2D DevTools"
        Width="1100" Height="800"
        MinWidth="900" MinHeight="700"
        Background="{StaticResource BackgroundBrush}"
        WindowStartupLocation="CenterScreen">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 헤더: 연결 상태 -->
        <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="CatTalk2D" FontSize="20" FontWeight="Bold"
                               Foreground="{StaticResource PrimaryBrush}" Margin="0,0,8,0"/>
                    <TextBlock Text="DevTools" FontSize="20" FontWeight="Light"
                               Foreground="{StaticResource TextBrush}" Margin="0,0,24,0"/>

                    <Ellipse Width="12" Height="12" Margin="0,0,8,0">
                        <Ellipse.Style>
                            <Style TargetType="Ellipse">
                                <Setter Property="Fill" Value="{StaticResource DangerBrush}"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsConnected}" Value="True">
                                        <Setter Property="Fill" Value="{StaticResource SuccessBrush}"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Ellipse.Style>
                    </Ellipse>
                    <TextBlock Text="{Binding ConnectionStatus}"
                               FontSize="14"
                               Foreground="{StaticResource TextBrush}"/>
                    <TextBlock Text="{Binding LastUpdate, StringFormat=' | {0}'}"
                               FontSize="12" Margin="16,0,0,0"
                               Foreground="{StaticResource SubTextBrush}"
                               Visibility="{Binding IsConnected, Converter={StaticResource BoolToVisibility}}"/>
                </StackPanel>

                <Button Grid.Column="1" Content="연결"
                        Command="{Binding ConnectCommand}"
                        Style="{StaticResource PrimaryButton}"
                        Margin="8,0"
                        IsEnabled="{Binding IsConnected, Converter={StaticResource InvertBool}}"/>
                <Button Grid.Column="2" Content="연결 해제"
                        Command="{Binding DisconnectCommand}"
                        Padding="12,8"
                        Background="{StaticResource SubTextBrush}"
                        Foreground="White" BorderThickness="0" Cursor="Hand"
                        IsEnabled="{Binding IsConnected}"/>
            </Grid>
        </Border>

        <!-- 메인: 탭 컨트롤 -->
        <TabControl Grid.Row="1" SelectedIndex="{Binding SelectedTabIndex}">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Padding" Value="16,8"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                </Style>
            </TabControl.Resources>

            <!-- 개발자 모드 탭 -->
            <TabItem Header="개발자 모드">
                <views:DevToolsTab DataContext="{Binding}"/>
            </TabItem>

            <!-- 로그 분석기 탭 -->
            <TabItem Header="로그 분석기">
                <views:LogAnalyzerTab DataContext="{Binding}"/>
            </TabItem>

            <!-- AI 튜닝 탭 -->
            <TabItem Header="AI 튜닝">
                <views:AITuningTab DataContext="{Binding}"/>
            </TabItem>
        </TabControl>

        <!-- 푸터: 에러 메시지 -->
        <Border Grid.Row="2" Margin="0,16,0,0"
                Visibility="{Binding LastError, Converter={StaticResource StringToVisibility}}">
            <TextBlock Text="{Binding LastError}"
                       Foreground="{StaticResource DangerBrush}"
                       FontSize="12"/>
        </Border>
    </Grid>
</Window>
